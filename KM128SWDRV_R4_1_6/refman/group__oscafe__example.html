<!-- HTML header for doxygen 1.8.9-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>MKMxxZxxACxx5 Bare Metal Software Drivers: AFE Clocked by 8.0 MHz OSC, FEE Mode</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="drivers.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nxp_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MKMxxZxxACxx5 Bare Metal Software Drivers
   &#160;<span id="projectnumber">R4.1.6</span>
   </div>
   <div id="projectbrief">Reference Manual</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="pages.html"><span>Pages</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__oscafe__example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AFE Clocked by 8.0 MHz OSC, FEE Mode<div class="ingroups"><a class="el" href="group__afe__drv.html">AFE Driver</a> &raquo; <a class="el" href="group__afe__examples.html">AFE Examples</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>This example shows System Oscillator (OSC), controlled by 8.0 MHz External Crystal, as the direct clocks source of the Analogue Front End (AFE) module. The FLL module is configured to operate in FEE mode generating 20.0 MHz (8.0 MHz / 256 * 640) Core clock and 10.0 MHz Bus/Flash clocks.</p>
<p>The 4.0 MHz 50% duty-cycle sigma delta modulator clock, derived from 8.0 MHz External Crystal, is routed to pin PTB7 for monitoring purposes. </p><dl class="section user"><dt>Source code:</dt><dd><div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * (c) Copyright 2010-2015, Freescale Semiconductor Inc.</span></div>
<div class="line"><span class="comment"> * ALL RIGHTS RESERVED.</span></div>
<div class="line"><span class="comment"> ******************************************************************************</span></div>
<div class="line"><span class="comment"> * oscafe_test.c</span></div>
<div class="line"><span class="comment"> ******************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#include &quot;drivers.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* global data definitions                                                    */</span></div>
<div class="line"><span class="keyword">volatile</span> <a class="code" href="group__basic__data__types.html#ga56f1a81c92849566ae864511088eb7e8" title="32-bit signed integer ">int32</a> result;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> main (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">/* enable clocks to all peripherals - clock mode 2:1:1 (core:bus:flash)     */</span></div>
<div class="line">  <a class="code" href="group__sim__macro.html#ga29bf1a8a2c379d066cbf00ce6f4b650b" title="SIM initialization. ">SIM_Init</a> (<a class="code" href="group__sim__config.html#ga899efbad9c2c6af161201c24aafd9e71" title="Full configuration. ">SIM_MODULE_ALL_PERIPH_ON_CONFIG</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* route bus clock to PTF7                                                  */</span></div>
<div class="line">  <a class="code" href="group__sim__macro.html#gad1bb8768e4d1bac7d61341da516acd39" title="Selects clock source for CLKOUT port pins. ">SIM_SelClkout</a> (<a class="code" href="group__clkout__src.html#gad7831a57b1d6b4535195856462322ceb" title="Bus clock. ">CLKOUT_SRC2</a>);</div>
<div class="line">  <a class="code" href="group__gpio__macro.html#ga08ba8a1cfbaa12687a20d9e609609160" title="PORT pin(s) initialization. ">PORT_Init</a> (PORTF,<a class="code" href="group__port__config.html#ga305750cfc2b11cbc99a808bcd905a879" title="Configures pin(s) to Alternative 3 (chip-specific) mode. ">PORT_MODULE_ALT3_MODE</a>,<a class="code" href="group__pin__names.html#gaf4d3f80395907ab4999773479f1aecf1" title="PIN 7 (MSB) ">PIN7</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* configures AFE_CLK pad to output mode and routes it to PTB7              */</span></div>
<div class="line">  <a class="code" href="group__sim__macro.html#ga0885b333af086dcbad28da82a7826f50" title="Selects AFE_CLK pin direction. ">SIM_SelAfeClkPadDir</a> (TRUE);</div>
<div class="line">  <a class="code" href="group__gpio__macro.html#ga08ba8a1cfbaa12687a20d9e609609160" title="PORT pin(s) initialization. ">PORT_Init</a> (PORTB,<a class="code" href="group__port__config.html#ga04f71ff96eecc9ab06c8923d7fc715ef" title="Configures pin(s) to Alternative 2 (chip-specific) mode. ">PORT_MODULE_ALT2_MODE</a>,<a class="code" href="group__pin__names.html#gaf4d3f80395907ab4999773479f1aecf1" title="PIN 7 (MSB) ">PIN7</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* system oscillator and FLL settings                                       */</span></div>
<div class="line">  <a class="code" href="group__osc__macro.html#ga45e625f1893ade49c06987f061997bbf" title="System oscillator initialization. ">OSC_Init</a> (<a class="code" href="group__osc__config.html#gaa0ed7965542e912c22eeefa2feb81106" title="Enables external reference clock (OSCERCLK). The OSCERCLK is enabled in STOP mode. ">OSC_MODULE_OSCERCLK_ON_STOPMODE_ON_CONFIG</a>(<a class="code" href="group__osc__load__caps.html#ga02c7e52d7798c6860a5d95830830ce0d" title="No internal load capacitor applied. ">OSC_SC0P</a>));</div>
<div class="line">  <a class="code" href="group__fll__macro.html#ga298ab412924c0bbeb4c4423bea476085" title="FLL initialization. ">FLL_Init</a> (<a class="code" href="group__fll__config.html#gac69415bc9a0183c290900d7d14984096" title="FLL Engaged External (DCO Range: 20 - 25 MHz). Clocked by System Oscillator Clock with Frequency Rang...">FLL_MODULE_FEE_20_25MHZ_DIV256_OSC_CONFIG</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* VREF module must be initialized after SIM module                         */</span></div>
<div class="line">  <a class="code" href="group__vref__macro.html#ga3b9c6be2a4e53c90f3185139709c9169" title="Voltage reference initialization. ">VREF_Init</a> (<a class="code" href="group__vref__module__config.html#ga546e266645fe33d6ca1a7a109ed9b331" title="Voltage reference setting. ">VREF_MODULE_CHOP_EN_ICOMP_EN_REG_EN_VREFL_EN_LPWR_CONFIG</a>,</div>
<div class="line">             <a class="code" href="group__vref__switch__config.html#ga76a2087bd1bf466c987b6625eb5f895f" title="Voltage reference switch setting. ">VREF_SWITCH_S1_L_S2_L_S3_L_BUFF_DI</a>);</div>
<div class="line">  <a class="code" href="group__vref__macro.html#ga996a9e70c90befba7b221a931e3dd99a" title="Lower reference voltage Trim value change. ">VREFL_Trim</a>( 3);                                 <span class="comment">/* VREFL trimmed to 0.400 V */</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* afe clocking directly from system oscillator                             */</span></div>
<div class="line">  <a class="code" href="group__sim__macro.html#ga71c44b6648fe67c5b601babef040d33d" title="Selects between PLL, FLL and OSC clocks as the source for the PLL clock branch for AFE Clock...">SIM_SelAfePllClk</a> (<a class="code" href="group__afe__clk__src.html#gaa5217e4ed55d38631f8ba7370e4323f6" title="OSCCLK external reference clock. ">SIM_OSC_CLK</a>);</div>
<div class="line">  <a class="code" href="group__afe__macro.html#gaef0d0e4c44baf43d723a8fc02a5d7d98" title="AFE channel initialization. ">AFE_ChInit</a> (<a class="code" href="group__channel__mask.html#ga90643238cf4f49aae5f0ab215ada7889" title="Channel 1. ">CH1</a>, <a class="code" href="group__afe__chan__config.html#ga727289d1b9b5488fa28812d43784046d" title="Selects software trigger continuous conversion mode. PGA is disabled. ">AFE_CH_SWTRG_CCM_PGAOFF_CONFIG</a>(<a class="code" href="group__afe__osr.html#ga9d3e7f4df65611f3c6a9f42ca9d0b3b4" title="f-3dB=25.15KHz,fn= 48KHz @ fs=6.144MHz ">DEC_OSR64</a>), 0, <a class="code" href="group__cm0plus__prilvl.html#ga3461048206d4aa48866deedbdd269c1b" title="Priority level 0 (highest priority) ">PRI_LVL0</a>, NULL);</div>
<div class="line">  <a class="code" href="group__afe__macro.html#ga0f56303b12f4aa8120a6e19a7cf0c231" title="AFE module initialization. ">AFE_Init</a>   (<a class="code" href="group__afe__module__config.html#gafa4e03728842780e9a86912708f2618a" title="Selects normal mode of operation with right justified 2&#39;s complement 32-bit output data format...">AFE_MODULE_RJFORMAT_CONFIG</a>(<a class="code" href="group__afe__clocks.html#ga826fcc5b87d37f2ea1eb1f07015b0c56" title="ICS_PLL(SIM_AFE_PLL_CLKSEL=00)  ICS_FLL(SIM_AFE_PLL_CLKSEL=01)  OSC_CLK(SIM_AFE_PLL_CLKSEL=10)  RESER...">AFE_PLL_CLK</a>, <a class="code" href="group__afe__clkdiv.html#gaad288f2810f940d9f8e9555a187b1bda" title="divide by 2 (default) ">AFE_DIV2</a>, 8000000));</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* trigger AFE operation by SW                                              */</span></div>
<div class="line">  <a class="code" href="group__afe__macro.html#ga0a8e7aabd9e1e19531edaa10bb6af2fd" title="Triggers conversion on selected AFE channel(s). ">AFE_SwTrigger</a> (<a class="code" href="group__channel__mask.html#ga90643238cf4f49aae5f0ab215ada7889" title="Channel 1. ">CH1</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* main loop                                                                */</span></div>
<div class="line">  <span class="keywordflow">while</span> (1)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__afe__macro.html#ga7f4693a787da2298c2d6f8d2ddef2ff5" title="Returns conversion status (COCx flag) for given AFE channel. ">AFE_ChReady</a>(<a class="code" href="group__channel__mask.html#ga90643238cf4f49aae5f0ab215ada7889" title="Channel 1. ">CH1</a>))</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="group__afe__macro.html#ga806de7822531369b003d99ef612ca6b5" title="Returns 2&#39;s complement 32-bit values of the selected channel result registers. ">AFE_Read</a> (<a class="code" href="group__channel__mask.html#ga90643238cf4f49aae5f0ab215ada7889" title="Channel 1. ">CH1</a>, &amp;result);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Toolchain support:</dt><dd><table class="doxtable">
<tr>
<th align="center"><code>IAR EWARM 7.40.7</code></th><th align="center"><code>CodeWarrior 10.6</code></th><th align="center"><code>KEIL uVision 5.15</code></th><th align="center"><code>CrossWorks 3.6</code></th><th align="center"><code>ATOLLIC TrueStudio 5.3.0</code></th><th align="center"><code>Kinetis Design Studio 3.0.0</code>  </th></tr>
<tr>
<td align="center"><b>&diams;</b> </td><td align="center"><b>&diams;</b> </td><td align="center"><b>&diams;</b> </td><td align="center"><b>&diams;</b> </td><td align="center"><b>&diams;</b> </td><td align="center"><b>&diams;</b> </td></tr>
</table>
</dd></dl>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul class="foot">
    <li class="footer">Tue Nov 22 2016 &copy; 2016 NXP Semiconductors, Inc. All rights reserved.
    </li>
  </ul>
</div>
</body>
</html>
